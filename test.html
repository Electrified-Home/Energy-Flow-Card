<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Energy Flow Card Preview</title>
    <script src="energy-flow-card.js"></script>
    <style>
      body { 
        font-family: system-ui; 
        max-width: 1200px; 
        margin: 40px auto; 
        padding: 20px; 
        background: #f5f5f5;
      }
      h1 { font-size: 1.5rem; margin-bottom: 1rem; }
      h2 { font-size: 1.2rem; margin-top: 2rem; margin-bottom: 0.5rem; }
      .panel {
        background: #fff;
        border-radius: 8px;
        padding: 16px;
        margin-bottom: 20px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      }
      
      /* Simulate Home Assistant form styling */
      .form-field {
        margin-bottom: 16px;
      }
      .form-field label {
        display: block;
        font-weight: 500;
        margin-bottom: 4px;
        font-size: 14px;
      }
      .form-field input[type="text"],
      .form-field input[type="number"] {
        width: 100%;
        padding: 8px 12px;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 14px;
        box-sizing: border-box;
      }
      .form-field input:focus {
        outline: none;
        border-color: #03a9f4;
      }
      .error-banner {
        background: #f44336;
        color: white;
        padding: 12px;
        border-radius: 4px;
        margin-bottom: 16px;
      }
    </style>
  </head>
  <body>
    <h1>Energy Flow Card Preview</h1>
    
    <h2>Card View</h2>
    <div class="panel">
      <energy-flow-card id="card"></energy-flow-card>
    </div>

    <h2>Configuration Editor</h2>
    <div class="panel">
      <energy-flow-card-editor id="editor"></energy-flow-card-editor>
    </div>

    <script>
      const card = document.getElementById('card');
      const editor = document.getElementById('editor');
      
      // Mock HASS object
      const hass = {
        states: {
          'sensor.grid_power': { state: '2.5', attributes: { unit_of_measurement: 'kW' } },
          'sensor.home_power': { state: '3.2', attributes: { unit_of_measurement: 'kW' } },
          'sensor.battery_power': { state: '-0.5', attributes: { unit_of_measurement: 'kW' } },
          'sensor.solar_power': { state: '4.2', attributes: { unit_of_measurement: 'kW' } }
        }
      };
      
      // Initial config
      const config = {
        type: 'custom:energy-flow-card',
        entities: {
          grid: 'sensor.grid_power',
          home: 'sensor.home_power',
          battery: 'sensor.battery_power',
          production: 'sensor.solar_power'
        },
        display: {
          unit: 'kW',
          decimals: 1,
          showIcons: true
        }
      };

      // Set up card
      card.setConfig(config);
      card.hass = hass;

      // Set up editor
      editor.setConfig(config);
      editor.hass = hass;

      // Listen for config changes from editor
      editor.addEventListener('config-changed', (event) => {
        const newConfig = event.detail.config;
        card.setConfig(newConfig);
      });
    </script>
  </body>
</html>
